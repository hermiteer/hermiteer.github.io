<html>
    <head>
        <script type="text/javascript">
            window.addEventListener('DOMContentLoaded', (event) => {

                // assemble params into url, then redirect
                const params = new URLSearchParams(window.location.search)
                const code = params.get("code")
                const scope = params.get("scope")
                const state = params.get("state")

                // TODO enable redirect when visionOS Safari supports it
                // const url = "RMBLMNK2://oauth-callback?code=" + code + "&scope=" + scope + "&state=" + state
                // document.getElementById("url").innerHTML = url
                // window.location.assign(url)

                // copy authorization code
                var copyCodeButton = document.getElementById("copy-code-button")
                copyCodeButton.addEventListener('click', function() {
                    if (!code) {
                        window.alert("There is no authorization code to copy");
                    } else {
                        window.navigator.clipboard.writeText(code);
                    }
                });
            });
        </script>
    </head>
    <body>
        <center>
            <br>
            <h2>
                Redirecting back to RMBLMNK2://oauth-callback...<br>
            </h2>
            <br>
            <input type="button" value="Copy authorization code" id="copy-code-button">
        </center>
    </body>
</html>
